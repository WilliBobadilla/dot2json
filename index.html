<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <title>dot2json</title>
</head>

<body>
    <h3>Dot to Json converter</h3>
    <div class="container">
        <div class="row">
            <div class="col-sm">
                <div id="toConvert">
                    <input type="text">
                </div>
                <br>
                <button onclick="addInput()"> + </button>
                <button onclick="convert()"> Convert </button>
            </div>
            <div class="col-sm" id="converted">
                <textarea name="output" id="output" cols="30" rows="10"></textarea>
            </div>

        </div>
    </div>
</body>
<script>
    function stringToObj(path, value, obj) {
        var objValue = value;
        try {
            objValue = JSON.parse(value);
        } catch (e) { } //eat the error, must not be json so carry on... Hack to do a valid JSON check

        var parts = path.split("."), part;
        var last = parts.pop();
        while (part = parts.shift()) {
            if (typeof obj[part] != "object")
                obj[part] = {};
            obj = obj[part];
        }
        if (obj.hasOwnProperty(last) && obj[last] && obj[last].constructor === Array) {
            obj[last].push(objValue);
        }
        else if (obj.hasOwnProperty(last) && obj[last]) {
            var objArray = [];
            objArray.push(obj[last])
            objArray.push(objValue);
            obj[last] = objArray;
        }
        else {
            obj[last] = objValue;
        }
    }

    function addInput() {
        var newInputText = document.createElement('input')
        newInputText.setAttribute('type', 'text')
        var toConvert = document.getElementById('toConvert')
        var space = document.createElement('br')
        toConvert.appendChild(space)
        toConvert.appendChild(newInputText)


    }
    function convert() {
        var divOfInputs = document.getElementById('toConvert').children
        var len = divOfInputs.length//don't forget the br element added between the inputs
        console.log(len)
        let i;
        let obj = {};
        for (i = 0; i < len; i++) {
            let data = divOfInputs[i];
            if (data.localName != 'br') {
                console.log(data.value)
                stringToObj(data.value, '', obj)
            }
        }
        console.log(obj)
        var output = document.getElementById('output')
        obj = JSON.stringify(obj)
        output.innerHTML = obj
    }


</script>

</html>